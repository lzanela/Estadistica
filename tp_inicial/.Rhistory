rm(list=ls())
setwd("~/Documentos/tp_stat")
setwd("C:/Users/lucaz/OneDrive/Documents/Exactas/Estadistica/tp_inicial")
data <- read.table("ENNyS_menorA2.txt", header = TRUE)
attach(data)
library(ggplot2)
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
View(data)
View(data)
perim_cef_hasta_2 <- data$Perim_cef
perim_cef <- data$Perim_cef
class(perim_cef)
sum(42 < perim_cef < 48)/length(perim_cef)
sum((42 < perim_cef) && (perim_cef < 48))/length(perim_cef)
sum((42 < perim_cef) & (perim_cef < 48))/length(perim_cef)
perim_cef <- data$Perim_cef
sum((42 < perim_cef) & (perim_cef < 48))/length(perim_cef)
data <- read.table("ENNyS_menorA2.txt", header = TRUE)
attach(data)
perim_cef <- data$Perim_cef
sum((42 < perim_cef) & (perim_cef < 48))/length(perim_cef)
epanechnikov <- density(perim_cef, kernel = "epanechnikov")
epanechnikov_cdf <- spatstat.core::CDF(epanechnikov)
install.packages(spatstat.core)
install.packages(spatstat)
install.packages("spatstat")
epanechnikov_cdf <- spatstat.core::CDF(epanechnikov)
library(spatstat.core)
library(spatstat)
epanechnikov_cdf <- spatstat.core::CDF(epanechnikov)
epanechnikov_cdf <- with(epanechnikov, splinefun(x, cumsum(y) / sum(y), method="monoH.FC"))
epanechnikov_cdf(48) - epanechnikov_cdf(42)
epanechnikov <- density(perim_cef, kernel = "epanechnikov")
epanechnikov_cdf <- with(epanechnikov, splinefun(x, cumsum(y) / sum(y), method="monoH.FC"))
epanechnikov_cdf(48) - epanechnikov_cdf(42)
perim_cef <- data$Perim_cef
sum((42 < perim_cef) & (perim_cef < 48))/length(perim_cef)
epanechnikov <- density(perim_cef, kernel = "epanechnikov")
epanechnikov_cdf <- with(epanechnikov, splinefun(x, cumsum(y) / sum(y), method="monoH.FC"))
epanechnikov_cdf(48) - epanechnikov_cdf(42)
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density))) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
, binwidth = 1
library(ggplot2)
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
hist_data <- hist(perim_cef, plot = FALSE)
hist_data <- hist(perim_cef, plot = FALSE, binwidth = 1)
total_area = sum(hist_data$density * diff(hist_data$breaks))
total_area = sum(hist_data$density * diff(hist_data$breaks))
total_area = sum(hist_data$density * diff(hist_data$breaks))
prob_hist = sum(hist_data$density[hist_data$breaks[-1] >= 42 & hist_data$breaks[-length(hist_data$breaks)] <= 48]) / total_area
sum(hist_data$density[hist_data$breaks[-1] >= 42 & hist_data$breaks[-length(hist_data$breaks)] <= 48]) / total_area
sum(hist_data$density[hist_data$breaks[-1] >= 42 & hist_data$breaks[-length(hist_data$breaks)] <= 48])
perim_cef <- data$Perim_cef
hist_data <- hist(perim_cef, plot = FALSE, binwidth = 1)
hist_data <- hist(perim_cef, plot = FALSE)
sum(hist_data$density[hist_data$breaks[-1] >= 42 & hist_data$breaks[-length(hist_data$breaks)] <= 48])
sum((42 < perim_cef) & (perim_cef < 48))/length(perim_cef)
perim_cef <- data$Perim_cef
hist_data <- hist(perim_cef, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices]) / length(perim_cef)
data <- read.table("ENNyS_menorA2.txt", header = TRUE)
attach(data)
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices]) / length(perim_cef)
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE, probability = TRUE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices])
hist_obj <- hist(perim_cef, plot = FALSE, freq = FALSE)
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE, freq = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices])
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE, freq = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices])
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE, freq = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices])
hist_obj <- hist(perim_cef, plot = FALSE)
# Calculate the width of each bin
bin_widths <- diff(hist_obj$breaks)
# Find the indices of bins that are entirely within the range 42 to 48
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
# Calculate the total number of observations within the range
# This accounts for the possibility of different bin widths, though typically they are the same
observations_in_range <- sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices])
# Calculate the probability estimate
total_observations <- length(perim_cef)
probability_estimate <- observations_in_range / total_observations
print(probability_estimate)
hist_data <- hist(data$Perim_cef, plot = FALSE)
total_area = sum(hist_data$density * diff(hist_data$breaks))
prob_hist = sum(hist_data$density[hist_data$breaks[-1] >= 42 & hist_data$breaks[-length(hist_data$breaks)] <= 48]) / total_area
print(prob_hist)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
-length(hist_data$breaks
-length(hist_data$breaks)
hist_data$breaks[-1]
hist_data$breaks[-1]
hist_data$breaks[-length(hist_data$breaks)]
print(prob_hist)
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE, freq = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
data <- read.table("ENNyS_menorA2.txt", header = TRUE)
attach(data)
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
hist_obj$density[in_range_indices]
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
hist_obj$breaks[in_range_indices]
data_range <- seq(floor(min(perim_cef)), ceiling(max(perim_cef)), by = 1)
hist_obj <- hist(perim_cef, breaks = data_range, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
hist_obj$breaks[in_range_indices]
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
library(ggplot2)
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
perim_cef <- data$Perim_cef
data_range <- seq(floor(min(perim_cef)), ceiling(max(perim_cef)), by = 1)
hist_obj <- hist(perim_cef, breaks = data_range, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
epanechnikov <- density(perim_cef, kernel = "epanechnikov")
epanechnikov_cdf <- with(epanechnikov, splinefun(x, cumsum(y) / sum(y), method="monoH.FC"))
epanechnikov_cdf(48) - epanechnikov_cdf(42)
data <- read.table("ENNyS_menorA2.txt", header = TRUE)
attach(data)
hist(Perim_cef, breaks=25, freq=FALSE)
lines(density(Perim_cef, kernel='gaussian'))
embarazo_simple <- data[data$Tipo_embarazo=='Simple',]
embarazo_multiple <- data[data$Tipo_embarazo=='Multiple',]
lines(density(embarazo_simple$Perim_cef, kernel='gaussian'),col='green')
lines(density(embarazo_multiple$Perim_cef, kernel='gaussian'),col='blue')
legend("topleft", legend = c("Embarazo Simple", "Embarazo Multiple"), col = c("green", "blue"), lty = 1, lwd = 2)
bagplot(Perim_cef, Talla, xlab='Perim_cef', ylab='Talla')
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) + geom_density(aes(x = Perim_cef, y = after_stat(density)), col = 'green', kernel = "rectangular", adjust = 2) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov", adjust = 2) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian", adjust = 2)
library(ggplot2)
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
library(aplpack)
install aplpack
bagplot(Perim_cef, Talla, xlab='Perim_cef', ylab='Talla')
data <- read.table("ENNyS_menorA2.txt", header = TRUE)
attach(data)
library(ggplot2)
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
library(ggplot2)
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
library(ggplot2)
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
data_range <- seq(floor(min(Perim_cef)), ceiling(max(Perim_cef)), by = 1)
hist_obj <- hist(Perim_cef, breaks = data_range, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
epanechnikov <- density(Perim_cef, kernel = "epanechnikov")
epanechnikov_cdf <- with(epanechnikov, splinefun(x, cumsum(y) / sum(y), method="monoH.FC"))
epanechnikov_cdf(48) - epanechnikov_cdf(42)
print(bw.nrd0(Perim_cef))
hist(Perim_cef,breaks = 25,freq = FALSE)
lines(density(Perim_cef, kernel='gaussian'),col='red')
sexoVaron <- data[Sexo =='Varon',]
sexoMujer <- data[Sexo == 'Mujer',]
lines(density(sexoVaron$Perim_cef, kernel='gaussian'),col='green')
lines(density(sexoMujer$Perim_cef, kernel='gaussian'),col='blue')
legend("topleft", legend = c("Sexo Varon", "Sexo Mujer"), col = c("green", "blue"), lty = 1, lwd = 2)
hist(Perim_cef, breaks=25, freq=FALSE)
lines(density(Perim_cef, kernel='gaussian'))
embarazo_simple <- data[Tipo_embarazo=='Simple',]
embarazo_multiple <- data[Tipo_embarazo=='Multiple',]
lines(density(embarazo_simple$Perim_cef, kernel='gaussian'),col='green')
lines(density(embarazo_multiple$Perim_cef, kernel='gaussian'),col='blue')
legend("topleft", legend = c("Embarazo Simple", "Embarazo Multiple"), col = c("green", "blue"), lty = 1, lwd = 2)
library(aplpack)
bagplot(Perim_cef, Talla, xlab='Perim_cef', ylab='Talla')
bagplot(Perim_cef, Talla, ylab='Perim_cef', xlab='Talla')
x
bagplot(Perim_cef, Talla, xlab='Perim_cef', ylab='Talla')
bagplot(Talla, Perim_cef, xlab='Perim_cef', ylab='Talla')
Perim_cef,
bagplot(Perim_cef, Talla, xlab='Perim_cef', ylab='Talla')
perim_cef_out <- boxplot.stats(Perim_cef)$out
talla_out <- boxplot.stats(Talla)$out
bagplot(Perim_cef[!Perim_cef %in% perim_cef_out], Talla[!Talla %in% talla_out], xlab='Perim_cef', ylab='Talla')
bagplot(Perim_cef[!Perim_cef %in% perim_cef_out & !Talla %in% talla_out], Talla[!Talla %in% talla_out & !Perim_cef %in% perim_cef_out], xlab='Perim_cef', ylab='Talla')
data_mujer <- data[Sexo=='Mujer',]
data_varon <- data[Sexo=='Varon',]
bagplot(data_mujer$Perim_cef, data_mujer$Talla, main="Mujer", xlab='Perim_cef', ylab='Talla')
bagplot(data_varon$Perim_cef, data_varon$Talla, main="Varon", xlab='Perim_cef', ylab='Talla')
perim_cef_out <- boxplot.stats(Perim_cef)$out
talla_out <- boxplot.stats(Talla)$out
bagplot(Perim_cef[!Perim_cef %in% perim_cef_out], Talla[!Talla %in% talla_out], xlab='Perim_cef', ylab='Talla')
perim_cef_out <- boxplot.stats(Perim_cef)$out
talla_out <- boxplot.stats(Talla)$out
bagplot(Perim_cef[!Perim_cef %in% perim_cef_out & !Talla %in% talla_out], Talla[!Talla %in% talla_out & !Perim_cef %in% perim_cef_out], xlab='Perim_cef', ylab='Talla')
bag <- bagplot(Perim_cef, Talla, xlab='Perim_cef', ylab='Talla')
View(bag)
bagplot(Perim_cef, Talla, show.outlier = FALSE, xlab='Perim_cef', ylab='Talla')
outliers <- bagplot(Perim_cef, Talla, create.plot = FALSE, xlab='Perim_cef', ylab='Talla')[pxy.outlier]
outliers <- bagplot(Perim_cef, Talla, create.plot = FALSE, xlab='Perim_cef', ylab='Talla')$pxy.outlier
View(outliers)
bagplot(Perim_cef[!Perim_cef %in% outliers | !Talla %in% outliers], Talla[!Perim_cef %in% outliers$x | !Talla %in% outliers$y], xlab='Perim_cef', ylab='Talla')
bagplot(Perim_cef[!Perim_cef %in% outliers | !Talla %in% outliers], Talla[!Perim_cef %in% outliers[x] | !Talla %in% outliers$y], xlab='Perim_cef', ylab='Talla')
bagplot(Perim_cef[!Perim_cef %in% outliers | !Talla %in% outliers], Talla[!(Perim_cef; Talla) %in% outliers | !Talla %in% outliers$y], xlab='Perim_cef', ylab='Talla')
outliers[1]
outliers[200]
outliers[107]
outliers[1:outliers.length]
outliers[1:length(outliers)]
outliers[1:length(outliers)/2]
outliers[1:107]
length(outliers)
outliers[1:107]
bagplot(Perim_cef[!Perim_cef %in% outliers[1:107] | !Talla %in% outliers[108:214]], Talla[!Perim_cef %in% outliers[1:107] | !Talla %in% outliers[108:214]], xlab='Perim_cef', ylab='Talla')
length(outliers)/2
bagplot(Perim_cef[!Perim_cef %in% outliers[1:borde] | !Talla %in% outliers[borde +1:borde*2]], Talla[!Perim_cef %in% outliers[1:borde] | !Talla %in% outliers[borde +1:borde*2]], xlab='Perim_cef', ylab='Talla')
outliers <- bagplot(Perim_cef, Talla, create.plot = FALSE, xlab='Perim_cef', ylab='Talla')$pxy.outlier
borde <- length(outliers)/2
bagplot(Perim_cef[!Perim_cef %in% outliers[1:borde] | !Talla %in% outliers[borde +1:borde*2]], Talla[!Perim_cef %in% outliers[1:borde] | !Talla %in% outliers[borde +1:borde*2]], xlab='Perim_cef', ylab='Talla')
outliers <- bagplot(Perim_cef, Talla, create.plot = FALSE, xlab='Perim_cef', ylab='Talla')$pxy.outlier
bagplot(Perim_cef[!Perim_cef %in% outliers[1:107] | !Talla %in% outliers[108:214]], Talla[!Perim_cef %in% outliers[1:107] | !Talla %in% outliers[108:214]], xlab='Perim_cef', ylab='Talla')
