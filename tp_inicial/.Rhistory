rm(list=ls())
setwd("~/Documentos/tp_stat")
setwd("C:/Users/lucaz/OneDrive/Documents/Exactas/Estadistica/tp_inicial")
data <- read.table("ENNyS_menorA2.txt", header = TRUE)
attach(data)
library(ggplot2)
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
View(data)
View(data)
perim_cef_hasta_2 <- data$Perim_cef
perim_cef <- data$Perim_cef
class(perim_cef)
sum(42 < perim_cef < 48)/length(perim_cef)
sum((42 < perim_cef) && (perim_cef < 48))/length(perim_cef)
sum((42 < perim_cef) & (perim_cef < 48))/length(perim_cef)
perim_cef <- data$Perim_cef
sum((42 < perim_cef) & (perim_cef < 48))/length(perim_cef)
data <- read.table("ENNyS_menorA2.txt", header = TRUE)
attach(data)
perim_cef <- data$Perim_cef
sum((42 < perim_cef) & (perim_cef < 48))/length(perim_cef)
epanechnikov <- density(perim_cef, kernel = "epanechnikov")
epanechnikov_cdf <- spatstat.core::CDF(epanechnikov)
install.packages(spatstat.core)
install.packages(spatstat)
install.packages("spatstat")
epanechnikov_cdf <- spatstat.core::CDF(epanechnikov)
library(spatstat.core)
library(spatstat)
epanechnikov_cdf <- spatstat.core::CDF(epanechnikov)
epanechnikov_cdf <- with(epanechnikov, splinefun(x, cumsum(y) / sum(y), method="monoH.FC"))
epanechnikov_cdf(48) - epanechnikov_cdf(42)
epanechnikov <- density(perim_cef, kernel = "epanechnikov")
epanechnikov_cdf <- with(epanechnikov, splinefun(x, cumsum(y) / sum(y), method="monoH.FC"))
epanechnikov_cdf(48) - epanechnikov_cdf(42)
perim_cef <- data$Perim_cef
sum((42 < perim_cef) & (perim_cef < 48))/length(perim_cef)
epanechnikov <- density(perim_cef, kernel = "epanechnikov")
epanechnikov_cdf <- with(epanechnikov, splinefun(x, cumsum(y) / sum(y), method="monoH.FC"))
epanechnikov_cdf(48) - epanechnikov_cdf(42)
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density))) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
, binwidth = 1
library(ggplot2)
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
hist_data <- hist(perim_cef, plot = FALSE)
hist_data <- hist(perim_cef, plot = FALSE, binwidth = 1)
total_area = sum(hist_data$density * diff(hist_data$breaks))
total_area = sum(hist_data$density * diff(hist_data$breaks))
total_area = sum(hist_data$density * diff(hist_data$breaks))
prob_hist = sum(hist_data$density[hist_data$breaks[-1] >= 42 & hist_data$breaks[-length(hist_data$breaks)] <= 48]) / total_area
sum(hist_data$density[hist_data$breaks[-1] >= 42 & hist_data$breaks[-length(hist_data$breaks)] <= 48]) / total_area
sum(hist_data$density[hist_data$breaks[-1] >= 42 & hist_data$breaks[-length(hist_data$breaks)] <= 48])
perim_cef <- data$Perim_cef
hist_data <- hist(perim_cef, plot = FALSE, binwidth = 1)
hist_data <- hist(perim_cef, plot = FALSE)
sum(hist_data$density[hist_data$breaks[-1] >= 42 & hist_data$breaks[-length(hist_data$breaks)] <= 48])
sum((42 < perim_cef) & (perim_cef < 48))/length(perim_cef)
perim_cef <- data$Perim_cef
hist_data <- hist(perim_cef, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices]) / length(perim_cef)
data <- read.table("ENNyS_menorA2.txt", header = TRUE)
attach(data)
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices]) / length(perim_cef)
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE, probability = TRUE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices])
hist_obj <- hist(perim_cef, plot = FALSE, freq = FALSE)
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE, freq = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices])
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE, freq = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices])
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE, freq = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices])
hist_obj <- hist(perim_cef, plot = FALSE)
# Calculate the width of each bin
bin_widths <- diff(hist_obj$breaks)
# Find the indices of bins that are entirely within the range 42 to 48
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
# Calculate the total number of observations within the range
# This accounts for the possibility of different bin widths, though typically they are the same
observations_in_range <- sum(hist_obj$counts[in_range_indices] * bin_widths[in_range_indices])
# Calculate the probability estimate
total_observations <- length(perim_cef)
probability_estimate <- observations_in_range / total_observations
print(probability_estimate)
hist_data <- hist(data$Perim_cef, plot = FALSE)
total_area = sum(hist_data$density * diff(hist_data$breaks))
prob_hist = sum(hist_data$density[hist_data$breaks[-1] >= 42 & hist_data$breaks[-length(hist_data$breaks)] <= 48]) / total_area
print(prob_hist)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
-length(hist_data$breaks
-length(hist_data$breaks)
hist_data$breaks[-1]
hist_data$breaks[-1]
hist_data$breaks[-length(hist_data$breaks)]
print(prob_hist)
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE, freq = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
data <- read.table("ENNyS_menorA2.txt", header = TRUE)
attach(data)
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
hist_obj$density[in_range_indices]
perim_cef <- data$Perim_cef
hist_obj <- hist(perim_cef, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
hist_obj$breaks[in_range_indices]
data_range <- seq(floor(min(perim_cef)), ceiling(max(perim_cef)), by = 1)
hist_obj <- hist(perim_cef, breaks = data_range, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
hist_obj$breaks[in_range_indices]
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
library(ggplot2)
ggplot() +
geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
perim_cef <- data$Perim_cef
data_range <- seq(floor(min(perim_cef)), ceiling(max(perim_cef)), by = 1)
hist_obj <- hist(perim_cef, breaks = data_range, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
epanechnikov <- density(perim_cef, kernel = "epanechnikov")
epanechnikov_cdf <- with(epanechnikov, splinefun(x, cumsum(y) / sum(y), method="monoH.FC"))
epanechnikov_cdf(48) - epanechnikov_cdf(42)
