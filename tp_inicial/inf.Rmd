---
title: "TP Inicial de Estadística"
output: html_document
date: "2024-03-26"
---

Leer la tabla

```{r,echo=TRUE}
data <- read.table("ENNyS_menorA2.txt", header = TRUE)
attach(data)
```

## Ejercicio 1

```{r,echo=TRUE}
library(ggplot2)

ggplot() +
  geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) +
  geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'rectangular'), kernel = "rectangular") +
  geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov") +
  geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian")
```

Como se observa en el gráfico, las densidades estimadas casi no presentan diferencias, por lo que no parece ser una ventaja utilizar un núcleo por sobre otro.

## Ejercicio 2

#### a) Estimación usando el histograma

```{r,echo=TRUE}
data_range <- seq(floor(min(Perim_cef)), ceiling(max(Perim_cef)), by = 1)
hist_obj <- hist(Perim_cef, breaks = data_range, plot = FALSE)
bin_widths <- diff(hist_obj$breaks)
in_range_indices <- which(hist_obj$mids >= 42 & hist_obj$mids <= 48)
sum(hist_obj$density[in_range_indices] * bin_widths[in_range_indices])
```

#### b) Estimación usando la densidad con núcleo de Epanechnikov

```{r,echo=TRUE}
epanechnikov <- density(Perim_cef, kernel = "epanechnikov")
epanechnikov_cdf <- with(epanechnikov, splinefun(x, cumsum(y) / sum(y), method="monoH.FC"))
epanechnikov_cdf(48) - epanechnikov_cdf(42)
```

No hay cuentas que justificar más allá del hecho de que la forma de estimar la probabilidad con el histograma es haciendo la suma de las áreas de las cajas del histograma que están comprendidas entre 42 y 48, y que $P_E\{42 < X < 48\} = P_E\{X < 48\} - P_E\{X < 42\}$, con $X$ siendo la variable aleatoria asociada al perímetro cefálico de un bebé y $P_E$ la función de distribución acumulada asociada a la densidad con núcleo de Epanechnikov.

## Ejercicio 3

Averiguamos las ventanas por defecto para cada núcleo (el parámetro $bw$). Según la documentación, se calcula con la función $\texttt{bw.nrd0(x)}$.

```{r,echo=TRUE}
print(bw.nrd0(Perim_cef))
```

Reduciendo la ventana a la mitad se obtienen las siguientes densidades (núcleo rectangular graficado en verde):

```{r,echo=TRUE}
ggplot() +
    geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) + geom_density(aes(x = Perim_cef, y = after_stat(density)), col = "green", kernel = "rectangular", adjust = 0.5) + 
  geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov", adjust = 0.5) +
  geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian", adjust = 0.5)
```

Duplicando las ventanas se obtienen las siguientes densidades:

```{r,echo=TRUE}
ggplot() +
    geom_histogram(aes(x = Perim_cef, y = after_stat(density)), binwidth = 1) + geom_density(aes(x = Perim_cef, y = after_stat(density)), col = 'green', kernel = "rectangular", adjust = 2) + 
  geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'epanechnikov'), kernel = "epanechnikov", adjust = 2) +
  geom_density(aes(x = Perim_cef, y = after_stat(density), col = 'gaussian'), kernel = "gaussian", adjust = 2)
```

##Ejercicio 5
```{r,echo=TRUE}
hist(Perim_cef, breaks=25, freq=FALSE)
lines(density(Perim_cef, kernel='gaussian'))
embarazo_simple <- data[data$Tipo_embarazo=='Simple',]
embarazo_multiple <- data[data$Tipo_embarazo=='Multiple',]
lines(density(embarazo_simple$Perim_cef, kernel='gaussian'),col='green')
lines(density(embarazo_multiple$Perim_cef, kernel='gaussian'),col='blue')
legend("topleft", legend = c("Embarazo Simple", "Embarazo Multiple"), col = c("green", "blue"), lty = 1, lwd = 2)
```